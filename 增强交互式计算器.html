<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åƒç«™æ¶²å†·è¶…å……é¡¹ç›® - å¢å¼ºäº¤äº’å¼æƒ…æ™¯é¢„æµ‹</title>
    <link rel="stylesheet" href="åº“é‡Œè“æš—å¤œä¸»é¢˜.css">
    <style>
        /* å¢å¼ºäº¤äº’å¼è®¡ç®—å™¨ç‰¹æœ‰æ ·å¼ */
        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .feature-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(0, 119, 192, 0.3);
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #B8C5D6;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            border-radius: 10px 10px 0 0;
        }

        .tab.active {
            color: #FFC72C;
            border-bottom-color: #FFC72C;
            background: rgba(255, 199, 44, 0.1);
        }

        .tab:hover {
            color: #FFFFFF;
            background: rgba(29, 66, 138, 0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .parameters-panel {
            background: rgba(26, 35, 71, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(0, 119, 192, 0.3);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .visualization-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .chart-container {
            background: rgba(26, 35, 71, 0.7);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 119, 192, 0.3);
            position: relative;
            overflow: hidden;
        }

        .chart-container.full-width {
            grid-column: 1 / -1;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #1D428A, #0077C0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .risk-assessment {
            background: rgba(26, 35, 71, 0.9);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(0, 119, 192, 0.3);
            margin-bottom: 30px;
        }

        .risk-factors {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .risk-factor {
            background: rgba(29, 66, 138, 0.3);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(0, 119, 192, 0.2);
            transition: all 0.3s ease;
        }

        .risk-factor:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 119, 192, 0.3);
            border-color: rgba(255, 199, 44, 0.4);
        }

        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .risk-name {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
        }

        .risk-level {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .risk-low {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .risk-medium {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .risk-high {
            background: rgba(244, 67, 54, 0.2);
            color: #F44336;
            border: 1px solid rgba(244, 67, 54, 0.3);
        }

        .risk-slider {
            width: 100%;
            margin: 15px 0;
        }

        .risk-description {
            color: #B8C5D6;
            font-size: 14px;
            line-height: 1.5;
        }

        .scenario-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .scenario-btn {
            padding: 12px 20px;
            border: 2px solid rgba(0, 119, 192, 0.3);
            border-radius: 25px;
            background: rgba(26, 35, 71, 0.7);
            color: #B8C5D6;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 14px;
        }

        .scenario-btn:hover {
            border-color: #FFC72C;
            color: #FFFFFF;
            background: rgba(29, 66, 138, 0.9);
            transform: translateY(-2px);
        }

        .scenario-btn.active {
            background: linear-gradient(135deg, #1D428A, #0077C0);
            border-color: #FFC72C;
            color: #FFFFFF;
            box-shadow: 0 4px 15px rgba(255, 199, 44, 0.3);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .result-card {
            background: rgba(26, 35, 71, 0.7);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 119, 192, 0.3);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #1D428A, #0077C0, #FFC72C);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .result-card:hover::before {
            transform: scaleX(1);
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 119, 192, 0.3);
            border-color: rgba(255, 199, 44, 0.4);
        }

        .result-value {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(135deg, #FFC72C, #FFD700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .result-label {
            font-size: 14px;
            color: #B8C5D6;
            font-weight: 500;
        }

        .result-trend {
            font-size: 12px;
            margin-top: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .trend-up {
            color: #4CAF50;
        }

        .trend-down {
            color: #F44336;
        }

        .param-group {
            margin-bottom: 25px;
        }

        .param-group-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row.single {
            grid-template-columns: 1fr;
        }

        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #1D428A, #0077C0);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0, 119, 192, 0.3);
        }

        .calculate-btn:hover {
            background: linear-gradient(135deg, #0077C0, #1D428A);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 119, 192, 0.4);
        }

        .export-btn {
            padding: 10px 20px;
            background: rgba(255, 199, 44, 0.1);
            border: 1px solid rgba(255, 199, 44, 0.3);
            color: #FFC72C;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .export-btn:hover {
            background: rgba(255, 199, 44, 0.2);
            border-color: #FFC72C;
            color: #FFFFFF;
        }

        .real-time-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            border-radius: 20px;
            font-size: 12px;
            color: #4CAF50;
            margin-left: 15px;
        }

        .real-time-dot {
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .sensitivity-chart {
            height: 300px;
            position: relative;
            background: rgba(10, 14, 39, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .chart-svg {
            width: 100%;
            height: 100%;
        }

        @media (max-width: 1200px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .parameters-panel {
                position: static;
            }

            .visualization-panel {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 15px;
            }

            .feature-tabs {
                gap: 10px;
            }

            .tab {
                padding: 12px 18px;
                font-size: 14px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .risk-factors {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <div class="header-section fade-in">
            <div class="header">
                <h1 class="title">å¢å¼ºäº¤äº’å¼æƒ…æ™¯é¢„æµ‹</h1>
                <p class="subtitle">å®æ—¶æ•°æ®å¯è§†åŒ– Â· æŠ•èµ„æƒ…æ™¯æ¨¡æ‹Ÿ Â· é£é™©è¯„ä¼°åˆ†æ</p>
                <div class="real-time-indicator">
                    <div class="real-time-dot"></div>
                    <span>å®æ—¶è®¡ç®—ä¸­</span>
                </div>
            </div>
        </div>

        <!-- åŠŸèƒ½æ ‡ç­¾é¡µ -->
        <div class="feature-tabs">
            <button class="tab active" onclick="switchTab('calculator')">
                ğŸ§® è´¢åŠ¡è®¡ç®—å™¨
            </button>
            <button class="tab" onclick="switchTab('scenarios')">
                ğŸ“Š æŠ•èµ„æƒ…æ™¯
            </button>
            <button class="tab" onclick="switchTab('risk')">
                âš ï¸ é£é™©è¯„ä¼°
            </button>
            <button class="tab" onclick="switchTab('visualization')">
                ğŸ“ˆ æ•°æ®å¯è§†åŒ–
            </button>
        </div>

        <!-- è´¢åŠ¡è®¡ç®—å™¨æ ‡ç­¾é¡µ -->
        <div id="calculator" class="tab-content active">
            <div class="calculator-grid">
                <!-- å‚æ•°é¢æ¿ -->
                <div class="parameters-panel">
                    <div class="param-group">
                        <div class="param-group-title">
                            <span>ğŸ—ï¸</span>
                            <span>åŸºç¡€è®¾æ–½å‚æ•°</span>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>æ€»æŠ•èµ„é¢ï¼ˆäº¿å…ƒï¼‰</label>
                                <input type="number" id="totalInvestment" value="28" min="1" max="100" step="1">
                            </div>
                            <div class="form-group">
                                <label>å»ºè®¾ç«™ç‚¹æ•°</label>
                                <input type="number" id="stationCount" value="1000" min="100" max="5000" step="100">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>å•ç«™åŠŸç‡ï¼ˆkWï¼‰</label>
                                <input type="number" id="stationPower" value="7200" min="1000" max="10000" step="100">
                            </div>
                            <div class="form-group">
                                <label>å»ºè®¾å‘¨æœŸï¼ˆå¹´ï¼‰</label>
                                <input type="number" id="constructionPeriod" value="4" min="1" max="10" step="1">
                            </div>
                        </div>
                    </div>

                    <div class="param-group">
                        <div class="param-group-title">
                            <span>ğŸ’°</span>
                            <span>è´¢åŠ¡å‚æ•°</span>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>å¹´å……ç”µé‡åˆ©ç”¨ç‡</label>
                                <input type="number" id="utilizationRate" value="25" min="5" max="50" step="1">
                            </div>
                            <div class="form-group">
                                <label>å……ç”µæœåŠ¡è´¹ï¼ˆå…ƒ/kWhï¼‰</label>
                                <input type="number" id="serviceFee" value="0.8" min="0.1" max="2" step="0.1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>è¿ç»´æˆæœ¬ç‡</label>
                                <input type="number" id="maintenanceCost" value="15" min="5" max="30" step="1">
                            </div>
                            <div class="form-group">
                                <label>æŠ˜ç°ç‡</label>
                                <input type="number" id="discountRate" value="12" min="5" max="20" step="1">
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateResults()">
                        å¼€å§‹è®¡ç®—
                    </button>
                </div>

                <!-- å¯è§†åŒ–é¢æ¿ -->
                <div class="visualization-panel">
                    <div class="chart-container">
                        <div class="chart-title">
                            <div class="chart-icon">ğŸ“ˆ</div>
                            <span>ç°é‡‘æµé¢„æµ‹</span>
                        </div>
                        <div id="cashflowChart" class="chart-placeholder">
                            <!-- ç°é‡‘æµå›¾è¡¨å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
                        </div>
                    </div>

                    <div class="chart-container">
                        <div class="chart-title">
                            <div class="chart-icon">ğŸ¯</div>
                            <span>IRRæ•æ„Ÿæ€§åˆ†æ</span>
                        </div>
                        <div id="irrChart" class="chart-placeholder">
                            <!-- IRRæ•æ„Ÿæ€§å›¾è¡¨å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
                        </div>
                    </div>

                    <div class="chart-container full-width">
                        <div class="chart-title">
                            <div class="chart-icon">ğŸ’¹</div>
                            <span>æŠ•èµ„å›æŠ¥åˆ†æ</span>
                            <button class="export-btn" onclick="exportChart()">å¯¼å‡ºå›¾è¡¨</button>
                        </div>
                        <div id="roiChart" class="chart-placeholder">
                            <!-- ROIåˆ†æå›¾è¡¨å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- è®¡ç®—ç»“æœ -->
            <div class="results-grid" id="resultsGrid">
                <div class="result-card">
                    <div class="result-value" id="irrValue">42.8%</div>
                    <div class="result-label">å†…éƒ¨æ”¶ç›Šç‡ (IRR)</div>
                    <div class="result-trend trend-up">â†‘ ä¼˜äºè¡Œä¸šå¹³å‡</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="npvValue">12.4äº¿</div>
                    <div class="result-label">å‡€ç°å€¼ (NPV@12%)</div>
                    <div class="result-trend trend-up">â†‘ æŠ•èµ„ä»·å€¼é«˜</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="paybackValue">4.5å¹´</div>
                    <div class="result-label">æŠ•èµ„å›æ”¶æœŸ</div>
                    <div class="result-trend trend-up">â†‘ å›æ”¶é€Ÿåº¦å¿«</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="profitValue">121.9äº¿</div>
                    <div class="result-label">10å¹´ç´¯è®¡åˆ©æ¶¦</div>
                    <div class="result-trend trend-up">â†‘ ç›ˆåˆ©èƒ½åŠ›å¼º</div>
                </div>
            </div>
        </div>

        <!-- æŠ•èµ„æƒ…æ™¯æ ‡ç­¾é¡µ -->
        <div id="scenarios" class="tab-content">
            <div class="scenario-buttons">
                <button class="scenario-btn" onclick="loadScenario('conservative')">æ‚²è§‚æƒ…æ™¯</button>
                <button class="scenario-btn active" onclick="loadScenario('baseline')">åŸºå‡†æƒ…æ™¯</button>
                <button class="scenario-btn" onclick="loadScenario('optimistic')">ä¹è§‚æƒ…æ™¯</button>
                <button class="scenario-btn" onclick="loadScenario('custom')">è‡ªå®šä¹‰æƒ…æ™¯</button>
            </div>

            <div class="visualization-panel">
                <div class="chart-container full-width">
                    <div class="chart-title">
                        <div class="chart-icon">ğŸ“Š</div>
                        <span>å¤šæƒ…æ™¯å¯¹æ¯”åˆ†æ</span>
                    </div>
                    <div id="scenarioChart" class="chart-placeholder">
                        <!-- æƒ…æ™¯å¯¹æ¯”å›¾è¡¨ -->
                    </div>
                </div>
            </div>

            <div class="results-grid" id="scenarioResults">
                <!-- æƒ…æ™¯åˆ†æç»“æœ -->
            </div>
        </div>

        <!-- é£é™©è¯„ä¼°æ ‡ç­¾é¡µ -->
        <div id="risk" class="tab-content">
            <div class="risk-assessment">
                <div class="chart-title">
                    <div class="chart-icon">âš ï¸</div>
                    <span>é£é™©è¯„ä¼°çŸ©é˜µ</span>
                    <button class="export-btn" onclick="exportRiskReport()">å¯¼å‡ºé£é™©æŠ¥å‘Š</button>
                </div>

                <div class="risk-factors">
                    <div class="risk-factor">
                        <div class="risk-header">
                            <div class="risk-name">ğŸ—ï¸ æŠ€æœ¯é£é™©</div>
                            <div class="risk-level risk-medium">ä¸­ç­‰</div>
                        </div>
                        <input type="range" class="risk-slider" id="techRisk" min="0" max="100" value="35">
                        <div class="risk-description">
                            æ¶²å†·è¶…å……æŠ€æœ¯æˆç†Ÿåº¦ã€è®¾å¤‡å¯é æ€§ã€æŠ€æœ¯è¿­ä»£é£é™©
                        </div>
                    </div>

                    <div class="risk-factor">
                        <div class="risk-header">
                            <div class="risk-name">ğŸ“ˆ å¸‚åœºé£é™©</div>
                            <div class="risk-level risk-low">è¾ƒä½</div>
                        </div>
                        <input type="range" class="risk-slider" id="marketRisk" min="0" max="100" value="25">
                        <div class="risk-description">
                            å¸‚åœºç«äº‰æ¿€çƒˆåº¦ã€éœ€æ±‚å¢é•¿é¢„æœŸã€ä»·æ ¼æ³¢åŠ¨é£é™©
                        </div>
                    </div>

                    <div class="risk-factor">
                        <div class="risk-header">
                            <div class="risk-name">ğŸ›ï¸ æ”¿ç­–é£é™©</div>
                            <div class="risk-level risk-medium">ä¸­ç­‰</div>
                        </div>
                        <input type="range" class="risk-slider" id="policyRisk" min="0" max="100" value="40">
                        <div class="risk-description">
                            è¡¥è´´æ”¿ç­–å˜åŒ–ã€è¡Œä¸šæ ‡å‡†æ›´æ–°ã€ç›‘ç®¡è¦æ±‚è°ƒæ•´
                        </div>
                    </div>

                    <div class="risk-factor">
                        <div class="risk-header">
                            <div class="risk-name">ğŸ’° è´¢åŠ¡é£é™©</div>
                            <div class="risk-level risk-low">è¾ƒä½</div>
                        </div>
                        <input type="range" class="risk-slider" id="financialRisk" min="0" max="100" value="20">
                        <div class="risk-description">
                            èèµ„æˆæœ¬å˜åŒ–ã€ç°é‡‘æµç¨³å®šæ€§ã€æ±‡ç‡æ³¢åŠ¨é£é™©
                        </div>
                    </div>

                    <div class="risk-factor">
                        <div class="risk-header">
                            <div class="risk-name">âš¡ è¿è¥é£é™©</div>
                            <div class="risk-level risk-medium">ä¸­ç­‰</div>
                        </div>
                        <input type="range" class="risk-slider" id="operationalRisk" min="0" max="100" value="30">
                        <div class="risk-description">
                            è¿ç»´ç®¡ç†å¤æ‚æ€§ã€äººå‘˜æŠ€èƒ½è¦æ±‚ã€è®¾å¤‡ç»´æŠ¤æˆæœ¬
                        </div>
                    </div>

                    <div class="risk-factor">
                        <div class="risk-header">
                            <div class="risk-name">ğŸŒ ç¯å¢ƒé£é™©</div>
                            <div class="risk-level risk-low">è¾ƒä½</div>
                        </div>
                        <input type="range" class="risk-slider" id="environmentalRisk" min="0" max="100" value="15">
                        <div class="risk-description">
                            ç¯ä¿è¦æ±‚å˜åŒ–ã€èƒ½æºæ”¿ç­–è°ƒæ•´ã€å¯æŒç»­å‘å±•å‹åŠ›
                        </div>
                    </div>
                </div>

                <div class="sensitivity-chart">
                    <h4 style="color: #FFFFFF; margin-bottom: 15px;">æ•æ„Ÿæ€§åˆ†æ - èœ˜è››å›¾</h4>
                    <svg id="riskSpiderChart" class="chart-svg">
                        <!-- èœ˜è››å›¾å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
                    </svg>
                </div>
            </div>
        </div>

        <!-- æ•°æ®å¯è§†åŒ–æ ‡ç­¾é¡µ -->
        <div id="visualization" class="tab-content">
            <div class="visualization-panel">
                <div class="chart-container">
                    <div class="chart-title">
                        <div class="chart-icon">ğŸŒ</div>
                        <span>å¸‚åœºè¶‹åŠ¿åˆ†æ</span>
                    </div>
                    <div id="marketTrendChart" class="chart-placeholder">
                        <!-- å¸‚åœºè¶‹åŠ¿å›¾è¡¨ -->
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">
                        <div class="chart-icon">ğŸš—</div>
                        <span>ç”µåŠ¨è½¦å¢é•¿é¢„æµ‹</span>
                    </div>
                    <div id="evGrowthChart" class="chart-placeholder">
                        <!-- ç”µåŠ¨è½¦å¢é•¿å›¾è¡¨ -->
                    </div>
                </div>

                <div class="chart-container full-width">
                    <div class="chart-title">
                        <div class="chart-icon">ğŸ’¡</div>
                        <span>æŠ€æœ¯æ¼”è¿›è·¯çº¿å›¾</span>
                    </div>
                    <div id="techRoadmapChart" class="chart-placeholder">
                        <!-- æŠ€æœ¯è·¯çº¿å›¾ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentScenario = 'baseline';
        let calculationResults = {};

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾é¡µ
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');

            // æ ¹æ®æ ‡ç­¾é¡µåˆå§‹åŒ–ç›¸åº”åŠŸèƒ½
            switch(tabName) {
                case 'calculator':
                    initCalculator();
                    break;
                case 'scenarios':
                    initScenarios();
                    break;
                case 'risk':
                    initRiskAssessment();
                    break;
                case 'visualization':
                    initVisualization();
                    break;
            }
        }

        // è´¢åŠ¡è®¡ç®—åŠŸèƒ½
        function calculateResults() {
            const params = {
                totalInvestment: parseFloat(document.getElementById('totalInvestment').value),
                stationCount: parseInt(document.getElementById('stationCount').value),
                stationPower: parseInt(document.getElementById('stationPower').value),
                constructionPeriod: parseInt(document.getElementById('constructionPeriod').value),
                utilizationRate: parseFloat(document.getElementById('utilizationRate').value),
                serviceFee: parseFloat(document.getElementById('serviceFee').value),
                maintenanceCost: parseFloat(document.getElementById('maintenanceCost').value),
                discountRate: parseFloat(document.getElementById('discountRate').value)
            };

            // è®¡ç®—æ ¸å¿ƒè´¢åŠ¡æŒ‡æ ‡
            const annualRevenue = params.stationCount * params.stationPower * params.utilizationRate / 100 * 365 * params.serviceFee / 1000;
            const annualCost = annualRevenue * params.maintenanceCost / 100;
            const annualProfit = annualRevenue - annualCost;

            // 10å¹´ç°é‡‘æµåˆ†æ
            let cashFlows = [];
            let cumulativeCashFlow = -params.totalInvestment * 10000; // è½¬æ¢ä¸ºä¸‡å…ƒ

            for (let year = 1; year <= 10; year++) {
                if (year <= params.constructionPeriod) {
                    // å»ºè®¾æœŸï¼Œé€æ­¥æŠ•èµ„
                    const investment = -params.totalInvestment * 10000 / params.constructionPeriod;
                    cumulativeCashFlow += investment;
                    cashFlows.push({
                        year: year,
                        investment: investment,
                        revenue: 0,
                        profit: investment,
                        cumulative: cumulativeCashFlow
                    });
                } else {
                    // è¿è¥æœŸ
                    cumulativeCashFlow += annualProfit;
                    cashFlows.push({
                        year: year,
                        investment: 0,
                        revenue: annualRevenue,
                        profit: annualProfit,
                        cumulative: cumulativeCashFlow
                    });
                }
            }

            // è®¡ç®—IRR
            const irr = calculateIRR(cashFlows.map(cf => cf.profit), params.totalInvestment * 10000);

            // è®¡ç®—NPV
            const npv = calculateNPV(cashFlows.map(cf => cf.profit), params.discountRate / 100);

            // è®¡ç®—æŠ•èµ„å›æ”¶æœŸ
            let paybackPeriod = 0;
            for (let i = 0; i < cashFlows.length; i++) {
                if (cashFlows[i].cumulative > 0) {
                    paybackPeriod = i;
                    break;
                }
            }

            // 10å¹´æ€»åˆ©æ¶¦
            const totalProfit = cashFlows.reduce((sum, cf) => sum + Math.max(0, cf.profit), 0);

            // æ›´æ–°ç»“æœæ˜¾ç¤º
            document.getElementById('irrValue').textContent = irr.toFixed(1) + '%';
            document.getElementById('npvValue').textContent = (npv / 10000).toFixed(1) + 'äº¿';
            document.getElementById('paybackValue').textContent = paybackPeriod + 'å¹´';
            document.getElementById('profitValue').textContent = (totalProfit / 10000).toFixed(1) + 'äº¿';

            // ä¿å­˜ç»“æœ
            calculationResults = {
                irr: irr,
                npv: npv,
                paybackPeriod: paybackPeriod,
                totalProfit: totalProfit,
                cashFlows: cashFlows,
                params: params
            };

            // æ›´æ–°å›¾è¡¨
            updateCharts();
        }

        // IRRè®¡ç®—å‡½æ•°
        function calculateIRR(cashFlows, initialInvestment) {
            let irr = 0.1; // åˆå§‹çŒœæµ‹å€¼
            let npv;
            const maxIterations = 100;
            const tolerance = 0.0001;

            for (let i = 0; i < maxIterations; i++) {
                npv = -initialInvestment;
                for (let j = 0; j < cashFlows.length; j++) {
                    npv += cashFlows[j] / Math.pow(1 + irr, j + 1);
                }

                if (Math.abs(npv) < tolerance) {
                    break;
                }

                // ç‰›é¡¿-æ‹‰å¤«é€Šæ³•
                let derivative = 0;
                for (let j = 0; j < cashFlows.length; j++) {
                    derivative -= (j + 1) * cashFlows[j] / Math.pow(1 + irr, j + 2);
                }

                irr = irr - npv / derivative;

                if (irr < -0.99) irr = -0.99; // é˜²æ­¢åˆ†æ¯ä¸ºé›¶
            }

            return irr * 100; // è½¬æ¢ä¸ºç™¾åˆ†æ¯”
        }

        // NPVè®¡ç®—å‡½æ•°
        function calculateNPV(cashFlows, discountRate) {
            let npv = 0;
            for (let i = 0; i < cashFlows.length; i++) {
                npv += cashFlows[i] / Math.pow(1 + discountRate, i + 1);
            }
            return npv;
        }

        // æ›´æ–°å›¾è¡¨
        function updateCharts() {
            drawCashflowChart();
            drawIRRChart();
            drawROIChart();
        }

        // ç»˜åˆ¶ç°é‡‘æµå›¾è¡¨
        function drawCashflowChart() {
            const container = document.getElementById('cashflowChart');
            if (!calculationResults.cashFlows) return;

            const data = calculationResults.cashFlows;
            const width = container.offsetWidth;
            const height = 250;
            const margin = { top: 20, right: 30, bottom: 40, left: 60 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            // åˆ›å»ºSVG
            const svg = `
                <svg width="${width}" height="${height}">
                    <g transform="translate(${margin.left},${margin.top})">
                        <!-- åæ ‡è½´ -->
                        <line x1="0" y1="${chartHeight}" x2="${chartWidth}" y2="${chartHeight}" stroke="#B8C5D6" stroke-width="2"/>
                        <line x1="0" y1="0" x2="0" y2="${chartHeight}" stroke="#B8C5D6" stroke-width="2"/>

                        <!-- ç°é‡‘æµæŸ±çŠ¶å›¾ -->
                        ${data.map((d, i) => {
                            const barWidth = chartWidth / data.length * 0.6;
                            const x = i * (chartWidth / data.length) + (chartWidth / data.length - barWidth) / 2;
                            const height = Math.abs(d.cumulative) / Math.max(...data.map(d => Math.abs(d.cumulative))) * chartHeight * 0.8;
                            const y = d.cumulative >= 0 ? chartHeight - height : chartHeight;

                            return `
                                <rect x="${x}" y="${y}" width="${barWidth}" height="${height}"
                                      fill="${d.cumulative >= 0 ? '#4CAF50' : '#F44336'}" opacity="0.8"/>
                                <text x="${x + barWidth/2}" y="${chartHeight + 20}"
                                      text-anchor="middle" fill="#B8C5D6" font-size="12">ç¬¬${d.year}å¹´</text>
                            `;
                        }).join('')}

                        <!-- æ ‡é¢˜ -->
                        <text x="${chartWidth/2}" y="-5" text-anchor="middle" fill="#FFFFFF" font-size="14">
                            ç´¯è®¡ç°é‡‘æµ (ä¸‡å…ƒ)
                        </text>
                    </g>
                </svg>
            `;

            container.innerHTML = svg;
        }

        // ç»˜åˆ¶IRRæ•æ„Ÿæ€§å›¾è¡¨
        function drawIRRChart() {
            const container = document.getElementById('irrChart');
            const width = container.offsetWidth;
            const height = 250;

            // æ¨¡æ‹Ÿæ•æ„Ÿæ€§æ•°æ®
            const scenarios = [
                { name: 'åˆ©ç”¨ç‡-20%', irr: 32.1 },
                { name: 'åŸºå‡†', irr: 42.8 },
                { name: 'åˆ©ç”¨ç‡+20%', irr: 53.4 },
                { name: 'æœåŠ¡è´¹-20%', irr: 35.2 },
                { name: 'æœåŠ¡è´¹+20%', irr: 50.3 },
                { name: 'æˆæœ¬-20%', irr: 48.9 },
                { name: 'æˆæœ¬+20%', irr: 36.7 }
            ];

            const svg = `
                <svg width="${width}" height="${height}">
                    <g transform="translate(40,20)">
                        <!-- åæ ‡è½´ -->
                        <line x1="0" y1="${height-40}" x2="${width-60}" y2="${height-40}" stroke="#B8C5D6" stroke-width="2"/>
                        <line x1="0" y1="0" x2="0" y2="${height-40}" stroke="#B8C5D6" stroke-width="2"/>

                        <!-- æŸ±çŠ¶å›¾ -->
                        ${scenarios.map((s, i) => {
                            const barWidth = (width-100) / scenarios.length * 0.6;
                            const x = i * ((width-100) / scenarios.length) + 20;
                            const barHeight = (s.irr / 60) * (height-60);
                            const y = height-40-barHeight;

                            return `
                                <rect x="${x}" y="${y}" width="${barWidth}" height="${barHeight}"
                                      fill="${s.name === 'åŸºå‡†' ? '#FFC72C' : '#0077C0'}" opacity="0.8"/>
                                <text x="${x + barWidth/2}" y="${y-5}" text-anchor="middle"
                                      fill="#FFFFFF" font-size="11">${s.irr}%</text>
                                <text x="${x + barWidth/2}" y="${height-25}" text-anchor="middle"
                                      fill="#B8C5D6" font-size="10" transform="rotate(-45 ${x + barWidth/2} ${height-25})">${s.name}</text>
                            `;
                        }).join('')}

                        <!-- æ ‡é¢˜ -->
                        <text x="${(width-100)/2}" y="-5" text-anchor="middle" fill="#FFFFFF" font-size="14">
                            IRRæ•æ„Ÿæ€§åˆ†æ (%)
                        </text>
                    </g>
                </svg>
            `;

            container.innerHTML = svg;
        }

        // ç»˜åˆ¶ROIåˆ†æå›¾è¡¨
        function drawROIChart() {
            const container = document.getElementById('roiChart');
            const width = container.offsetWidth;
            const height = 300;

            // æ¨¡æ‹ŸROIæ•°æ®
            const years = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            const roiData = years.map(year => ({
                year: year,
                investment: year <= 4 ? -7 : 0,
                return: year > 4 ? 12.19 : 0,
                cumulativeROI: year > 4 ? ((year-4) * 12.19 - 28) / 28 * 100 : -100 + (year * 25)
            }));

            const svg = `
                <svg width="${width}" height="${height}">
                    <g transform="translate(60,20)">
                        <!-- åæ ‡è½´ -->
                        <line x1="0" y1="${height-40}" x2="${width-80}" y2="${height-40}" stroke="#B8C5D6" stroke-width="2"/>
                        <line x1="0" y1="0" x2="0" y2="${height-40}" stroke="#B8C5D6" stroke-width="2"/>

                        <!-- é›¶çº¿ -->
                        <line x1="0" y1="${height-80}" x2="${width-80}" y2="${height-80}"
                              stroke="#FFC72C" stroke-width="1" stroke-dasharray="5,5"/>

                        <!-- ROIæŠ˜çº¿å›¾ -->
                        <polyline points="${roiData.map(d =>
                            `${(d.year-1) * (width-100) / 9},${height-80-d.cumulativeROI * 1.5}`
                        ).join(' ')}"
                                  fill="none" stroke="#FFC72C" stroke-width="3"/>

                        <!-- æ•°æ®ç‚¹ -->
                        ${roiData.map(d => `
                            <circle cx="${(d.year-1) * (width-100) / 9}"
                                    cy="${height-80-d.cumulativeROI * 1.5}" r="5" fill="#FFC72C"/>
                            <text x="${(d.year-1) * (width-100) / 9}" y="${height-25}"
                                  text-anchor="middle" fill="#B8C5D6" font-size="12">ç¬¬${d.year}å¹´</text>
                        `).join('')}

                        <!-- æ ‡é¢˜ -->
                        <text x="${(width-100)/2}" y="-5" text-anchor="middle" fill="#FFFFFF" font-size="16">
                            æŠ•èµ„å›æŠ¥ç‡ (ROI) è¶‹åŠ¿
                        </text>

                        <!-- Yè½´æ ‡ç­¾ -->
                        <text x="-10" y="5" text-anchor="end" fill="#B8C5D6" font-size="12">100%</text>
                        <text x="-10" y="${height-80}" text-anchor="end" fill="#B8C5D6" font-size="12">0%</text>
                        <text x="-10" y="${height-40}" text-anchor="end" fill="#B8C5D6" font-size="12">-100%</text>
                    </g>
                </svg>
            `;

            container.innerHTML = svg;
        }

        // åŠ è½½æŠ•èµ„æƒ…æ™¯
        function loadScenario(scenario) {
            currentScenario = scenario;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.scenario-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ ¹æ®æƒ…æ™¯è°ƒæ•´å‚æ•°
            const scenarios = {
                conservative: {
                    utilizationRate: 20,
                    serviceFee: 0.6,
                    maintenanceCost: 18,
                    totalInvestment: 32
                },
                baseline: {
                    utilizationRate: 25,
                    serviceFee: 0.8,
                    maintenanceCost: 15,
                    totalInvestment: 28
                },
                optimistic: {
                    utilizationRate: 35,
                    serviceFee: 1.0,
                    maintenanceCost: 12,
                    totalInvestment: 25
                },
                custom: {
                    // ä¿æŒå½“å‰å‚æ•°
                }
            };

            const params = scenarios[scenario];
            if (params && scenario !== 'custom') {
                document.getElementById('utilizationRate').value = params.utilizationRate;
                document.getElementById('serviceFee').value = params.serviceFee;
                document.getElementById('maintenanceCost').value = params.maintenanceCost;
                document.getElementById('totalInvestment').value = params.totalInvestment;
            }

            // é‡æ–°è®¡ç®—
            calculateResults();
        }

        // åˆå§‹åŒ–è®¡ç®—å™¨
        function initCalculator() {
            calculateResults();
        }

        // åˆå§‹åŒ–æƒ…æ™¯åˆ†æ
        function initScenarios() {
            drawScenarioChart();
        }

        // ç»˜åˆ¶æƒ…æ™¯å¯¹æ¯”å›¾è¡¨
        function drawScenarioChart() {
            const container = document.getElementById('scenarioChart');
            const width = container.offsetWidth;
            const height = 300;

            const scenarios = [
                { name: 'æ‚²è§‚æƒ…æ™¯', irr: 32.1, npv: 8.2, payback: 5.8 },
                { name: 'åŸºå‡†æƒ…æ™¯', irr: 42.8, npv: 12.4, payback: 4.5 },
                { name: 'ä¹è§‚æƒ…æ™¯', irr: 58.3, npv: 21.8, payback: 3.2 }
            ];

            const svg = `
                <svg width="${width}" height="${height}">
                    <g transform="translate(60,20)">
                        <!-- åæ ‡è½´ -->
                        <line x1="0" y1="${height-40}" x2="${width-80}" y2="${height-40}" stroke="#B8C5D6" stroke-width="2"/>
                        <line x1="0" y1="0" x2="0" y2="${height-40}" stroke="#B8C5D6" stroke-width="2"/>

                        <!-- IRRæŸ±çŠ¶å›¾ -->
                        ${scenarios.map((s, i) => {
                            const barWidth = 80;
                            const x = i * 120;
                            const height = (s.irr / 70) * (height-60);
                            const y = height-40-height;

                            return `
                                <rect x="${x}" y="${y}" width="${barWidth}" height="${height}"
                                      fill="#0077C0" opacity="0.8"/>
                                <text x="${x + barWidth/2}" y="${y-5}" text-anchor="middle"
                                      fill="#FFFFFF" font-size="14">${s.irr}%</text>
                                <text x="${x + barWidth/2}" y="${height-25}" text-anchor="middle"
                                      fill="#B8C5D6" font-size="12">${s.name}</text>
                                <text x="${x + barWidth/2}" y="${height-10}" text-anchor="middle"
                                      fill="#FFC72C" font-size="11">å›æ”¶æœŸ${s.payback}å¹´</text>
                            `;
                        }).join('')}

                        <!-- æ ‡é¢˜ -->
                        <text x="${(width-100)/2}" y="-5" text-anchor="middle" fill="#FFFFFF" font-size="16">
                            æŠ•èµ„æƒ…æ™¯å¯¹æ¯”åˆ†æ
                        </text>
                    </g>
                </svg>
            `;

            container.innerHTML = svg;
        }

        // åˆå§‹åŒ–é£é™©è¯„ä¼°
        function initRiskAssessment() {
            drawRiskSpiderChart();
        }

        // ç»˜åˆ¶é£é™©è¯„ä¼°èœ˜è››å›¾
        function drawRiskSpiderChart() {
            const svg = document.getElementById('riskSpiderChart');
            const width = svg.clientWidth;
            const height = 250;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 2 - 40;

            const risks = [
                { name: 'æŠ€æœ¯é£é™©', value: 35 },
                { name: 'å¸‚åœºé£é™©', value: 25 },
                { name: 'æ”¿ç­–é£é™©', value: 40 },
                { name: 'è´¢åŠ¡é£é™©', value: 20 },
                { name: 'è¿è¥é£é™©', value: 30 },
                { name: 'ç¯å¢ƒé£é™©', value: 15 }
            ];

            const angleStep = (Math.PI * 2) / risks.length;

            let paths = [];
            let labels = [];

            risks.forEach((risk, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;

                // ç½‘æ ¼çº¿
                paths.push(`<line x1="${centerX}" y1="${centerY}" x2="${x}" y2="${y}"
                                stroke="#B8C5D6" stroke-width="1" opacity="0.3"/>`);

                // é£é™©å€¼ç‚¹
                const value = risk.value / 100;
                const vx = centerX + Math.cos(angle) * radius * value;
                const vy = centerY + Math.sin(angle) * radius * value;

                labels.push(`
                    <text x="${x + 20 * Math.cos(angle)}" y="${y + 20 * Math.sin(angle)}"
                          text-anchor="middle" fill="#B8C5D6" font-size="12">${risk.name}</text>
                    <circle cx="${vx}" cy="${vy}" r="4" fill="#FFC72C"/>
                `);
            });

            svg.innerHTML = `
                ${paths.join('')}
                <!-- é£é™©åŒºåŸŸ -->
                <polygon points="${risks.map((risk, i) => {
                    const angle = i * angleStep - Math.PI / 2;
                    const value = risk.value / 100;
                    const x = centerX + Math.cos(angle) * radius * value;
                    const y = centerY + Math.sin(angle) * radius * value;
                    return `${x},${y}`;
                }).join(' ')}" fill="#0077C0" opacity="0.3" stroke="#0077C0" stroke-width="2"/>
                ${labels.join('')}
            `;
        }

        // åˆå§‹åŒ–æ•°æ®å¯è§†åŒ–
        function initVisualization() {
            drawMarketTrendChart();
            drawEVGrowthChart();
            drawTechRoadmapChart();
        }

        // ç»˜åˆ¶å¸‚åœºè¶‹åŠ¿å›¾è¡¨
        function drawMarketTrendChart() {
            const container = document.getElementById('marketTrendChart');
            // æ¨¡æ‹Ÿå¸‚åœºè¶‹åŠ¿æ•°æ®å¯è§†åŒ–
            container.innerHTML = `
                <div style="color: #B8C5D6; text-align: center; padding: 40px;">
                    <h4 style="color: #FFFFFF; margin-bottom: 20px;">å……ç”µæ¡©å¸‚åœºå¢é•¿è¶‹åŠ¿</h4>
                    <p>2023å¹´ï¼š300äº¿å…ƒ â†’ 2028å¹´ï¼š1250äº¿å…ƒ</p>
                    <p style="color: #FFC72C; font-size: 24px; font-weight: bold; margin: 20px 0;">å¹´å¤åˆå¢é•¿ç‡ 35%</p>
                    <div style="display: flex; justify-content: space-around; margin-top: 30px;">
                        <div>
                            <div style="color: #4CAF50; font-size: 18px;">ğŸ“ˆ</div>
                            <div>æ”¿ç­–é©±åŠ¨</div>
                        </div>
                        <div>
                            <div style="color: #0077C0; font-size: 18px;">ğŸš—</div>
                            <div>ç”µåŠ¨è½¦æ™®åŠ</div>
                        </div>
                        <div>
                            <div style="color: #FFC72C; font-size: 18px;">âš¡</div>
                            <div>æŠ€æœ¯å‡çº§</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ç»˜åˆ¶ç”µåŠ¨è½¦å¢é•¿å›¾è¡¨
        function drawEVGrowthChart() {
            const container = document.getElementById('evGrowthChart');
            container.innerHTML = `
                <div style="color: #B8C5D6; text-align: center; padding: 40px;">
                    <h4 style="color: #FFFFFF; margin-bottom: 20px;">ç”µåŠ¨è½¦ä¿æœ‰é‡é¢„æµ‹</h4>
                    <div style="display: flex; justify-content: space-around; align-items: center; height: 150px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #B8C5D6;">2023å¹´</div>
                            <div style="font-size: 18px; color: #4CAF50; margin: 10px 0;">950ä¸‡è¾†</div>
                            <div>æ¸—é€ç‡ 35%</div>
                        </div>
                        <div style="font-size: 30px; color: #FFC72C;">â†’</div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #FFFFFF;">2028å¹´</div>
                            <div style="font-size: 18px; color: #0077C0; margin: 10px 0;">7000ä¸‡è¾†</div>
                            <div>æ¸—é€ç‡ 60%</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: rgba(29, 66, 138, 0.3); border-radius: 10px;">
                        <div style="color: #FFC72C;">ğŸ’¡ å……ç”µéœ€æ±‚å°†åŒæ­¥å¢é•¿7.4å€</div>
                    </div>
                </div>
            `;
        }

        // ç»˜åˆ¶æŠ€æœ¯è·¯çº¿å›¾
        function drawTechRoadmapChart() {
            const container = document.getElementById('techRoadmapChart');
            container.innerHTML = `
                <div style="color: #B8C5D6; padding: 20px;">
                    <h4 style="color: #FFFFFF; margin-bottom: 20px;">æ¶²å†·è¶…å……æŠ€æœ¯æ¼”è¿›è·¯çº¿</h4>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="text-align: center; flex: 1;">
                            <div style="background: rgba(76, 175, 80, 0.2); border: 1px solid #4CAF50; border-radius: 10px; padding: 15px;">
                                <div style="font-size: 16px; font-weight: bold; color: #4CAF50;">å½“å‰</div>
                                <div style="margin: 10px 0;">600kW</div>
                                <div style="font-size: 12px;">æ¶²å†·è¶…å……</div>
                            </div>
                        </div>
                        <div style="font-size: 24px; color: #B8C5D6; margin: 0 20px;">â†’</div>
                        <div style="text-align: center; flex: 1;">
                            <div style="background: rgba(0, 119, 192, 0.2); border: 1px solid #0077C0; border-radius: 10px; padding: 15px;">
                                <div style="font-size: 16px; font-weight: bold; color: #0077C0;">2025å¹´</div>
                                <div style="margin: 10px 0;">800kW</div>
                                <div style="font-size: 12px;">ä¸‹ä¸€ä»£è¶…å……</div>
                            </div>
                        </div>
                        <div style="font-size: 24px; color: #B8C5D6; margin: 0 20px;">â†’</div>
                        <div style="text-align: center; flex: 1;">
                            <div style="background: rgba(255, 199, 44, 0.2); border: 1px solid #FFC72C; border-radius: 10px; padding: 15px;">
                                <div style="font-size: 16px; font-weight: bold; color: #FFC72C;">2028å¹´</div>
                                <div style="margin: 10px 0;">1000kW</div>
                                <div style="font-size: 12px;">å…†ç“¦çº§å……ç”µ</div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: rgba(29, 66, 138, 0.3); border-radius: 10px; text-align: center;">
                        <div style="color: #FFC72C;">ğŸš€ æŠ€æœ¯æŒç»­è¿­ä»£ï¼Œä¿æŒè¡Œä¸šé¢†å…ˆåœ°ä½</div>
                    </div>
                </div>
            `;
        }

        // å¯¼å‡ºåŠŸèƒ½
        function exportChart() {
            alert('å›¾è¡¨å¯¼å‡ºåŠŸèƒ½ï¼šæ”¯æŒPNGã€PDFã€Excelæ ¼å¼å¯¼å‡º');
        }

        function exportRiskReport() {
            alert('é£é™©è¯„ä¼°æŠ¥å‘Šå¯¼å‡ºï¼šåŒ…å«å®Œæ•´é£é™©åˆ†æå’Œåº”å¯¹å»ºè®®');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initCalculator();

            // ç›‘å¬å‚æ•°å˜åŒ–ï¼Œå®æ—¶æ›´æ–°è®¡ç®—
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    if (document.getElementById('calculator').classList.contains('active')) {
                        calculateResults();
                    }
                });
            });

            // ç›‘å¬é£é™©æ»‘å—å˜åŒ–
            const riskSliders = document.querySelectorAll('.risk-slider');
            riskSliders.forEach(slider => {
                slider.addEventListener('input', function() {
                    updateRiskLevel(this);
                    drawRiskSpiderChart();
                });
            });
        });

        // æ›´æ–°é£é™©ç­‰çº§æ˜¾ç¤º
        function updateRiskLevel(slider) {
            const value = parseInt(slider.value);
            const riskElement = slider.parentElement.querySelector('.risk-level');

            let level, className;
            if (value < 30) {
                level = 'ä½';
                className = 'risk-low';
            } else if (value < 60) {
                level = 'ä¸­ç­‰';
                className = 'risk-medium';
            } else {
                level = 'é«˜';
                className = 'risk-high';
            }

            riskElement.textContent = level;
            riskElement.className = 'risk-level ' + className;
        }
    </script>
</body>
</html>
