
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="stylesheet" href="库里蓝暗夜主题.css">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>千站液冷超充项目商业计划书</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #FFFFFF !important;
            background: #0A0E27;
            padding: 20px;
        }

        /* 正常页面布局 - 取消A4页面分割 */
        .page-container {
            display: block;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page {
            width: 100%;
            background: rgba(26, 35, 71, 0.95);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px;
            margin: 0 0 30px 0;
            position: relative;
        }

        .page:last-child {
            margin-bottom: 0;
            page-break-after: auto;
        }

        /* A4页面内容容器 */
        .page-content {
            height: 100%;
            overflow: hidden; /* 单页模式不滚动 */
            position: relative;
        }

        /* A4页面尺寸标识 */
        .page::before {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 56px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            z-index: 1;
        }

        /* 页码显示 */
        .page-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: normal;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #FFC72C;
            padding-bottom: 20px;
        }

        .title {
            font-size: 32px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 18px;
            color: #B8C5E0 !important;
            margin-bottom: 5px;
        }

        .meta {
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        .section {
            margin-bottom: 25px;
            page-break-inside: avoid;
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            border-left: 5px solid #FFC72C;
            padding-left: 15px;
        }

        .subsection-title {
            font-size: 18px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin: 15px 0 10px 0;
        }

        .highlight-box {
            background: rgba(255, 199, 44, 0.1);
            border: 2px solid #FFC72C;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-title {
            font-size: 20px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 10px;
            text-align: center;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .data-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .data-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: #FFC72C;
            background: rgba(255, 255, 255, 0.12);
        }

        .data-value {
            font-size: 24px;
            font-weight: bold;
            color: #FFC72C !important;
            margin-bottom: 5px;
        }

        .data-label {
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px;
            text-align: left;
        }

        th {
            background: rgba(255, 199, 44, 0.2);
            font-weight: bold;
            color: #FFFFFF !important;
        }

        td {
            color: #B8C5E0 !important;
        }

        .highlight-row {
            background: rgba(255, 199, 44, 0.15);
            font-weight: bold;
        }

        .highlight-row td {
            color: #FFFFFF !important;
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        li {
            margin-bottom: 5px;
            color: #B8C5E0 !important;
        }

        .conclusion {
            background: rgba(255, 199, 44, 0.1);
            border: 2px solid #FFC72C;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .conclusion-title {
            font-size: 20px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            text-align: center;
        }

        .contact {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        .page-break {
            page-break-before: always;
        }

        .chart-placeholder {
            background: #f3f4f6;
            border: 2px dashed #9ca3af;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            color: #6b7280;
            margin: 20px 0;
        }

        @media print {
            .page {
                box-shadow: none;
                margin: 0;
            }
        }

        /* 图表和图片样式 */
        .chart-container {
            margin: 20px 0;
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            page-break-inside: avoid;
            max-width: 100%;
            overflow: hidden;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-container canvas {
            max-width: 100%;
            height: auto !important;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: block;
            margin: 0 auto;
        }

        .image-container {
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            page-break-inside: avoid;
        }

        .image-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF !important;
            margin-bottom: 12px;
            text-align: center;
        }

        .image-wrapper {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .content-image {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .image-caption {
            font-size: 14px;
            color: #B8C5E0 !important;
            margin-top: 10px;
            font-style: italic;
            line-height: 1.4;
        }

        .tech-images-grid {
            display: grid;
            grid-template-columns: 1fr; /* 单页模式改为单列 */
            gap: 25px;
            margin: 20px 0;
        }

        @media (max-width: 1200px) {
            .tech-images-grid {
                grid-template-columns: 1fr;
            }
        }

    
        /* 响应式设计 - A4页面单页自适应布局 */
        @media (max-width: 1200px) {
            .page-container {
                max-width: 500px;
                padding: 15px;
            }

            .page {
                max-width: 100%;
                min-height: 708px; /* 保持A4比例 */
                padding: 35px 25px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
                background: #0A0E27;
            }

            .page-container {
                padding: 10px;
                max-width: 100%;
            }

            .page {
                padding: 25px 20px;
                margin: 0 auto 20px;
                min-height: auto;
                min-height: 600px; /* 移动端适中高度 */
                border-radius: 15px;
            }

            .page-content {
                overflow: visible; /* 移动端允许内容正常显示 */
            }

            .page::before {
                display: none; /* 移动端隐藏A4标识 */
            }

            .page-number {
                bottom: 10px;
                right: 15px;
            }

            .page-break {
                page-break-before: auto;
                margin-top: 30px;
                border-top: 2px solid rgba(255, 199, 44, 0.3);
                padding-top: 30px;
            }

            .title {
                font-size: 24px;
            }

            .section-title {
                font-size: 20px;
            }

            .data-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .tech-images-grid {
                grid-template-columns: 1fr;
            }

            .charts-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            /* PDF导出按钮移动端适配 */
            .pdf-export-section {
                bottom: 20px;
                right: 20px;
            }

            .pdf-export-btn {
                padding: 12px 20px;
                font-size: 14px;
            }
        }

        /* 超小屏幕适配 */
        @media (max-width: 480px) {
            .page-container {
                padding: 5px;
            }

            .page {
                padding: 20px 15px;
                margin: 0 auto 15px;
                min-height: 500px;
                border-radius: 10px;
            }

            .title {
                font-size: 20px;
            }

            .section-title {
                font-size: 18px;
            }

            .data-grid {
                grid-template-columns: 1fr;
            }

            .header {
                margin-bottom: 20px;
            }

            .pdf-export-section {
                bottom: 15px;
                right: 15px;
            }

            .pdf-export-btn {
                padding: 10px 15px;
                font-size: 13px;
                box-shadow: 0 5px 15px rgba(29, 66, 138, 0.3);
            }
        }

        /* 大屏幕单页适配 */
        @media (min-width: 1400px) {
            .page-container {
                max-width: 650px;
                padding: 30px;
            }

            .page {
                max-width: 100%;
                min-height: 918px; /* 保持A4比例 */
                padding: 45px 35px;
            }
        }

        /* 超大屏幕单页适配 */
        @media (min-width: 1800px) {
            .page-container {
                max-width: 700px;
                padding: 40px;
            }

            .page {
                max-width: 100%;
                min-height: 988px; /* 保持A4比例 */
                padding: 50px 40px;
            }
        }

        /* PDF导出按钮样式 */
        .pdf-export-section {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .pdf-export-btn {
            background: linear-gradient(135deg, #1D428A 0%, #0077C0 100%);
            color: #FFFFFF;
            border: none;
            padding: 15px 25px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 25px rgba(29, 66, 138, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .pdf-export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(29, 66, 138, 0.4);
            background: linear-gradient(135deg, #0077C0 0%, #1D428A 100%);
        }

        .pdf-export-btn:active {
            transform: translateY(0);
        }

        /* 隐藏PDF导出按钮在移动端 */
        @media (max-width: 768px) {
            .pdf-export-section {
                bottom: 20px;
                right: 20px;
            }

            .pdf-export-btn {
                padding: 12px 20px;
                font-size: 14px;
            }
        }

        /* 打印样式优化 - 单页模式 */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .page-container {
                display: block !important;
                max-width: none;
                padding: 0;
            }

            .page {
                width: 210mm;
                min-height: 297mm;
                max-width: none;
                margin: 0;
                padding: 15mm;
                background: white;
                box-shadow: none;
                border: none;
                border-radius: 0;
                page-break-after: always;
                overflow: hidden;
            }

            .page:last-child {
                page-break-after: auto;
            }

            .page-content {
                overflow: hidden;
            }

            .page-number {
                color: #666 !important;
            }

            .chart-container, .image-container {
                background: white;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }

            .chart-title, .image-title {
                color: #1D428A !important;
            }

            .section {
                page-break-inside: avoid;
            }

            canvas {
                max-height: 300px !important;
            }

            .content-image {
                max-height: 400px !important;
            }

            .pdf-export-section {
                display: none !important;
            }

            /* 打印时显示所有页面 */
            .page {
                display: block !important;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="page">
            <div class="page-content">
            <!-- 标题页 -->
            <div class="header">
                <h1 class="title">千站液冷超充项目</h1>
                <h2 class="subtitle">商业计划书</h2>
            </div>

            <!-- 项目概述 -->
            <div class="section">
                <h3 class="section-title">1. 项目概述</h3>

                <h4 class="subsection-title">1.1 项目简介</h4>
                <p>千站液冷超充项目计划在5年内建设1000座华为液冷超充站，总投资28亿元人民币。项目采用华为领先的全液冷超充技术，实现"一秒一公里"的充电速度，为新能源车主提供极致的充电体验。</p>

                <div class="highlight-box">
                    <h4 class="highlight-title">核心投资亮点</h4>
                    <ul>
                        <li><strong>技术领先</strong>：华为全液冷超充技术，功率密度行业领先</li>
                        <li><strong>市场巨大</strong>：中国充电桩市场年复合增长率35%</li>
                        <li><strong>投资安全</strong>：多重退出机制，风险可控</li>
                        <li><strong>回报丰厚</strong>：10年投资回报率435%，年化收益率42.8%</li>
                    </ul>
                </div>

                <h4 class="subsection-title">1.2 核心数据</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">28亿元</div>
                        <div class="data-label">总投资规模</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">1000座</div>
                        <div class="data-label">充电站数量</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">7200kW</div>
                        <div class="data-label">单站功率</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">4.5年</div>
                        <div class="data-label">投资回收期</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">42.8%</div>
                        <div class="data-label">项目IRR</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">600kW</div>
                        <div class="data-label">单枪功率</div>
                    </div>
                </div>
            </div>

            <!-- 市场分析 -->
            <div class="section">
                <h3 class="section-title">2. 市场分析</h3>

                <h4 class="subsection-title">2.1 行业背景</h4>
                <p>中国新能源汽车产业正处于爆发式增长期。2023年中国新能源汽车销量达950万辆，渗透率超过35%。预计到2028年，中国电动车保有量将达到7000万辆，充电桩需求将超过3800万个。</p>

                <div class="chart-container">
                    <h4 class="chart-title">新能源汽车市场增长趋势</h4>
                    <canvas id="investorMarketGrowthChart" width="500" height="280"></canvas>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">充电桩市场规模预测</h4>
                    <canvas id="investorMarketSizeChart" width="500" height="280"></canvas>
                </div>

                <h4 class="subsection-title">2.2 市场规模</h4>
                <ul>
                    <li><strong>全球充电桩市场</strong>：预计2030年达1253.9亿美元</li>
                    <li><strong>中国市场规模</strong>：占全球市场份额的67.4%</li>
                    <li><strong>年复合增长率</strong>：35%</li>
                    <li><strong>超充市场</strong>：从2023年的120亿元增长至2028年的800亿元</li>
                </ul>

                <h4 class="subsection-title">2.3 竞争分析</h4>
                <table>
                    <thead>
                        <tr>
                            <th>竞争对手</th>
                            <th>技术特点</th>
                            <th>市场份额</th>
                            <th>功率水平</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>特来电</td>
                            <td>群管群控技术</td>
                            <td>35%</td>
                            <td>480kW</td>
                        </tr>
                        <tr>
                            <td>星星充电</td>
                            <td>互联网运营</td>
                            <td>30%</td>
                            <td>480kW</td>
                        </tr>
                        <tr>
                            <td>国家电网</td>
                            <td>电网资源优势</td>
                            <td>15%</td>
                            <td>360kW</td>
                        </tr>
                        <tr class="highlight-row">
                            <td><strong>华为液冷超充</strong></td>
                            <td><strong>液冷技术领先</strong></td>
                            <td><strong>目标10%</strong></td>
                            <td><strong>600kW</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 技术方案 -->
            <div class="section">
                <h3 class="section-title">3. 技术方案</h3>

                <h4 class="subsection-title">3.1 华为液冷超充技术</h4>
                <table>
                    <thead>
                        <tr>
                            <th>技术指标</th>
                            <th>华为液冷超充</th>
                            <th>传统充电桩</th>
                            <th>提升幅度</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>最大功率</td>
                            <td>600kW</td>
                            <td>120-180kW</td>
                            <td>3.3-5倍</td>
                        </tr>
                        <tr>
                            <td>充电速度</td>
                            <td>"一秒一公里"</td>
                            <td>"一分钟一公里"</td>
                            <td>60倍</td>
                        </tr>
                        <tr>
                            <td>散热效率</td>
                            <td>300W/°C</td>
                            <td>100W/°C</td>
                            <td>3倍</td>
                        </tr>
                        <tr>
                            <td>设备噪音</td>
                            <td>&lt;60dB</td>
                            <td>75dB</td>
                            <td>降低20%</td>
                        </tr>
                        <tr>
                            <td>使用寿命</td>
                            <td>15年</td>
                            <td>8-10年</td>
                            <td>1.5-1.9倍</td>
                        </tr>
                        <tr>
                            <td>转换效率</td>
                            <td>&gt;96%</td>
                            <td>93-95%</td>
                            <td>1-3%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div>
        </div>

        <div class="page page-break">
            <div class="page-content">
            <!-- 继续技术方案 -->
            <div class="section">
                <h3 class="section-title">3. 技术方案 (续)</h3>

                <h4 class="subsection-title">3.2 系统架构图</h4>

                <p>千站液冷超充系统采用华为领先的全液冷超充技术，构建了三层架构设计，实现了"一秒一公里"的极致充电体验。系统集成了云端管理平台、场站控制系统和充电设备层，确保高效、安全、稳定的运营服务。</p>

                <div class="chart-container">
                    <h4 class="chart-title">系统整体架构</h4>
                    <canvas id="systemArchitectureChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>三层架构设计：</strong>云端管理平台负责大数据分析、智能调度和远程监控；场站控制系统实现本地设备管理、功率分配和安全保护；充电设备层提供600kW大功率充电输出，支持液冷散热和智能诊断。各层通过高速通信网络互联，确保实时响应和高效协同。
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">电力系统架构</h4>
                    <canvas id="powerSystemChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>智能电力分配：</strong>采用10kV双回路供电，配置2000kVA变压器，通过智能功率分配模块动态调节各充电桩输出。系统支持削峰填谷、需求响应等智能电网功能，确保电网稳定运行的同时最大化充电效率。功率因数≥0.99，总谐波失真＜3%。
                    </p>
                </div>
            </div>
            </div>
        </div>

        <div class="page page-break">
            <div class="page-content">
            <!-- 继续技术方案 -->
            <div class="section">
                <h3 class="section-title">3. 技术方案 (续)</h3>

                <div class="chart-container">
                    <h4 class="chart-title">液冷系统原理</h4>
                    <canvas id="coolingSystemChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>全液冷散热技术：</strong>采用循环冷却液系统，散热效率比传统风冷提升300%。系统工作温度-40~65℃，冷却液流量20L/min，可带走35kW热量。智能温控系统实时监测设备温度，自动调节冷却功率，确保充电模块在最佳温度范围内运行，大幅延长设备寿命。
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">充电站布局</h4>
                    <canvas id="stationLayoutChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>标准化场站设计：</strong>单个场站占地1000m²，布局12台600kW超充桩，采用4×3网格布局，确保车辆进出便利。站内配备休息室、便利店等配套设施，提升用户体验。标准化设计支持快速复制建设，单站建设周期仅需45天，大幅降低建设成本。
                    </p>
                </div>

                <p>系统采用模块化设计，支持灵活扩展。每个充电站配置12台600kW液冷超充桩，总功率7200kW，通过智能化功率分配算法，实现车辆充电需求的精准匹配。液冷散热系统确保设备24/7稳定运行，转换效率超过96%，为用户提供可靠的充电服务。整体系统具备故障自愈能力，可用性达到99.9%，支撑大规模商业化运营。</p>
            </div>

            <!-- 投资方案 -->
            <div class="section">
                <h3 class="section-title">4. 投资方案</h3>

                <h4 class="subsection-title">4.1 投资规划</h4>
                <table>
                    <thead>
                        <tr>
                            <th>阶段</th>
                            <th>时间</th>
                            <th>站点数量</th>
                            <th>投资额(亿元)</th>
                            <th>融资比例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>第一期</td>
                            <td>2024年</td>
                            <td>100座</td>
                            <td>3.5</td>
                            <td>60%</td>
                        </tr>
                        <tr>
                            <td>第二期</td>
                            <td>2025年</td>
                            <td>200座</td>
                            <td>6.8</td>
                            <td>65%</td>
                        </tr>
                        <tr>
                            <td>第三期</td>
                            <td>2026年</td>
                            <td>300座</td>
                            <td>9.9</td>
                            <td>70%</td>
                        </tr>
                        <tr>
                            <td>第四期</td>
                            <td>2027年</td>
                            <td>400座</td>
                            <td>12.8</td>
                            <td>75%</td>
                        </tr>
                        <tr class="highlight-row">
                            <td><strong>合计</strong></td>
                            <td><strong>4年</strong></td>
                            <td><strong>1000座</strong></td>
                            <td><strong>33.0</strong></td>
                            <td><strong>70%</strong></td>
                        </tr>
                    </tbody>
                </table>

                <h4 class="subsection-title">4.2 融资方案</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">23.1亿</div>
                        <div class="data-label">股权融资(70%)</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">9.9亿</div>
                        <div class="data-label">债权融资(30%)</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">3.0亿</div>
                        <div class="data-label">政府补贴</div>
                    </div>
                </div>

                <h4 class="subsection-title">4.3 退出机制</h4>
                <ol>
                    <li><strong>IPO上市</strong>：预计估值500-800亿元</li>
                    <li><strong>战略并购</strong>：预期收益倍数8-15倍</li>
                    <li><strong>REITs退出</strong>：稳定收益6-8%</li>
                </ol>
            </div>

            <!-- 财务分析 -->
            <div class="section">
                <h3 class="section-title">5. 财务分析</h3>

                <h4 class="subsection-title">5.1 投资回报分析</h4>
                <div class="highlight-box">
                    <h4 class="highlight-title">关键财务指标</h4>
                    <div class="data-grid">
                        <div class="data-card">
                            <div class="data-value">28亿</div>
                            <div class="data-label">总投资</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">42.8%</div>
                            <div class="data-label">项目IRR</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">12.4亿</div>
                            <div class="data-label">NPV@12%</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">4.5年</div>
                            <div class="data-label">投资回收期</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">121.9亿</div>
                            <div class="data-label">10年累计净利润</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">435%</div>
                            <div class="data-label">投资回报率</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">现金流预测分析</h4>
                    <canvas id="investorCashFlowChart" width="500" height="280"></canvas>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">投资回报率对比</h4>
                    <canvas id="investorROIChart" width="500" height="280"></canvas>
                </div>
            </div>
            </div>
        </div>

        <!-- 第四页用于PDF导出 -->
        <div class="page page-break" id="pdf-third-page">
            <div class="page-content">
            <!-- 继续财务分析 -->
            <div class="section">
                <h3 class="section-title">5. 财务分析 (续)</h3>

                <h4 class="subsection-title">5.2 敏感性分析</h4>
                <table>
                    <thead>
                        <tr>
                            <th>情景</th>
                            <th>IRR</th>
                            <th>投资回收期</th>
                            <th>NPV@12%</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>悲观(-20%)</td>
                            <td>22.5%</td>
                            <td>6.8年</td>
                            <td>4.2亿元</td>
                        </tr>
                        <tr class="highlight-row">
                            <td>基准</td>
                            <td>42.8%</td>
                            <td>4.5年</td>
                            <td>12.4亿元</td>
                        </tr>
                        <tr>
                            <td>乐观(+20%)</td>
                            <td>58.3%</td>
                            <td>3.2年</td>
                            <td>21.8亿元</td>
                        </tr>
                    </tbody>
                </table>

                <h4 class="subsection-title">5.3 REITs证券化</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">20座</div>
                        <div class="data-label">首期REITs站数</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">2.1亿</div>
                        <div class="data-label">资产估值</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">6.0%</div>
                        <div class="data-label">可分派率</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">1.7亿</div>
                        <div class="data-label">现金回流</div>
                    </div>
                </div>
            </div>

            <!-- 结论与建议 -->
            <div class="conclusion">
                <h3 class="conclusion-title">投资价值总结与建议</h3>

                <h4 class="subsection-title">核心投资亮点</h4>
                <ol>
                    <li><strong>技术领先优势</strong>：华为液冷超充技术处于行业领先地位</li>
                    <li><strong>市场时机优越</strong>：新能源汽车市场爆发式增长</li>
                    <li><strong>财务回报丰厚</strong>：42.8%的IRR，4.5年投资回收期</li>
                    <li><strong>风险控制完善</strong>：多重退出机制，风险可控</li>
                    <li><strong>社会效益显著</strong>：支持国家碳中和战略</li>
                </ol>

                <h4 class="subsection-title">投资建议</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">强烈推荐</div>
                        <div class="data-label">投资评级</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">23.1亿</div>
                        <div class="data-label">建议投资额</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">5-7年</div>
                        <div class="data-label">投资期限</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">15-25倍</div>
                        <div class="data-label">预期收益</div>
                    </div>
                </div>

                <h4 class="subsection-title">立即行动项</h4>
                <ol>
                    <li><strong>资金到位</strong>：90天内完成SPA和资金到账</li>
                    <li><strong>团队组建</strong>：招聘核心技术和运营团队</li>
                    <li><strong>场地签约</strong>：启动首批100个场地签约</li>
                    <li><strong>设备采购</strong>：与华为签订设备采购协议</li>
                </ol>
            </div>

            <!-- 最后说明 -->
            <div class="contact">
                <p><em>本商业计划书包含前瞻性陈述，实际投资回报可能因市场变化而调整。</em></p>
            </div>
        </div>
    </div>

    <!-- PDF导出区域 -->
    <div id="pdf-export-area" style="display: none;">
        <!-- 隐藏的PDF导出区域 -->
    </div>

    <!-- 导出PDF按钮 -->
    <div class="pdf-export-section">
        <button class="pdf-export-btn" onclick="exportToPDF()">
            <span>📄</span>
            <span>导出为PDF</span>
        </button>
    </div>

    <script>
        // 图表渲染函数
        function renderInvestorMarketGrowthChart() {
            const canvas = document.getElementById('investorMarketGrowthChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 数据
            const years = ['2020', '2021', '2022', '2023', '2024', '2025', '2026', '2027', '2028'];
            const salesData = [137, 352, 689, 950, 1200, 1500, 1850, 2250, 2700];
            const penetrationData = [5.4, 13.4, 25.6, 35.2, 42.0, 48.5, 54.2, 59.8, 64.5];

            // 设置样式 - 适配库里蓝暗夜主题
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                accent: '#FFC72C',
                text: '#FFFFFF',
                bg: '#B8C5E0'
            };

            // 绘制坐标轴
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, height - 60);
            ctx.lineTo(width - 30, height - 60);
            ctx.moveTo(50, 20);
            ctx.lineTo(50, height - 60);
            ctx.stroke();

            // 绘制销量曲线（左轴）
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 3;
            ctx.beginPath();

            const maxSales = Math.max(...salesData);
            const salesScale = (height - 100) / maxSales;

            salesData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                const y = height - 60 - value * salesScale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                // 绘制数据点
                ctx.fillStyle = colors.primary;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.stroke();

            // 绘制渗透率曲线（右轴）
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.beginPath();

            const maxPenetration = Math.max(...penetrationData);
            const penetrationScale = (height - 100) / maxPenetration;

            penetrationData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                const y = height - 60 - value * penetrationScale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                // 绘制数据点
                ctx.fillStyle = colors.success;
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.stroke();

            // 绘制标签
            ctx.fillStyle = colors.text;
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';

            // X轴标签
            years.forEach((year, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                ctx.fillText(year, x, height - 45);
            });

            // 图例
            ctx.fillStyle = colors.primary;
            ctx.fillRect(width - 150, 10, 15, 3);
            ctx.fillStyle = colors.text;
            ctx.font = '11px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('销量 (万辆)', width - 130, 14);

            ctx.fillStyle = colors.success;
            ctx.fillRect(width - 150, 25, 15, 3);
            ctx.fillText('渗透率 (%)', width - 130, 29);
        }

        function renderInvestorMarketSizeChart() {
            const canvas = document.getElementById('investorMarketSizeChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 数据
            const segments = ['液冷超充', '普通快充', '慢充', '其他'];
            const marketData = [800, 1200, 600, 400];
            const colors = ['#1D428A', '#0077C0', '#10B981', '#FFC72C'];

            // 绘制饼图
            const centerX = width / 2;
            const centerY = height / 2 - 10;
            const radius = Math.min(width, height) / 3;

            const total = marketData.reduce((sum, value) => sum + value, 0);
            let currentAngle = -Math.PI / 2;

            marketData.forEach((value, index) => {
                const sliceAngle = (value / total) * 2 * Math.PI;

                // 绘制扇形
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.lineTo(centerX, centerY);
                ctx.fillStyle = colors[index];
                ctx.fill();

                // 绘制边框
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.stroke();

                // 绘制百分比标签
                const percentage = ((value / total) * 100).toFixed(1);
                const labelAngle = currentAngle + sliceAngle / 2;
                const labelX = centerX + Math.cos(labelAngle) * (radius * 0.7);
                const labelY = centerY + Math.sin(labelAngle) * (radius * 0.7);

                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 14px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(percentage + '%', labelX, labelY);

                currentAngle += sliceAngle;
            });

            // 添加图例
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';

            segments.forEach((segment, index) => {
                const legendY = 20 + index * 20;
                ctx.fillStyle = colors[index];
                ctx.fillRect(10, legendY - 8, 12, 12);

                ctx.fillStyle = '#374151';
                ctx.fillText(`${segment}: ${marketData[index]}亿元`, 28, legendY);
            });

            // 添加标题
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 14px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('2028年充电桩市场规模预测 (亿元)', width / 2, height - 10);
        }

        function renderInvestorCashFlowChart() {
            const canvas = document.getElementById('investorCashFlowChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 数据
            const years = ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5', 'Year 6', 'Year 7', 'Year 8', 'Year 9', 'Year 10'];
            const cashFlowData = [-28.0, 13.5, 14.8, 17.9, 21.3, 26.5, 28.9, 31.2, 33.8, 36.5];
            const cumulativeData = [-28.0, -14.5, 0.3, 18.2, 39.5, 66.0, 94.9, 126.1, 159.9, 196.4];

            // 设置样式
            const colors = {
                primary: '#1D428A',
                success: '#10B981',
                danger: '#EF4444'
            };

            // 绘制坐标轴
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(50, 20);
            ctx.lineTo(50, height - 40);
            ctx.stroke();

            // 绘制现金流柱状图
            const barWidth = (width - 100) / years.length * 0.6;
            const scale = (height - 80) / 50;

            cashFlowData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / years.length) + ((width - 100) / years.length - barWidth) / 2;
                const barHeight = Math.abs(value) * scale;
                const y = value >= 0 ? height - 40 - barHeight : height - 40;

                ctx.fillStyle = value >= 0 ? colors.success : colors.danger;
                ctx.fillRect(x, y, barWidth, barHeight);

                // 绘制数值标签
                ctx.fillStyle = '#374151';
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(value.toFixed(1), x + barWidth / 2, y - 5);
            });

            // 绘制累计现金流曲线
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 2;
            ctx.beginPath();

            cumulativeData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                const y = height - 40 - (value + 30) * scale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();

            // 绘制X轴标签
            ctx.fillStyle = '#6b7280';
            ctx.font = '10px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            years.forEach((year, index) => {
                const x = 50 + (index * (width - 100) / years.length) + ((width - 100) / years.length) / 2;
                ctx.fillText(year, x, height - 25);
            });

            // 添加图例
            ctx.fillStyle = colors.success;
            ctx.fillRect(width - 150, 10, 15, 10);
            ctx.fillStyle = '#374151';
            ctx.font = '11px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('年现金流', width - 130, 19);

            ctx.fillStyle = colors.primary;
            ctx.fillRect(width - 150, 25, 15, 2);
            ctx.fillText('累计现金流', width - 130, 29);
        }

        function renderInvestorROIChart() {
            const canvas = document.getElementById('investorROIChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 数据
            const scenarios = ['Conservative', 'Base', 'Optimistic'];
            const irrData = [35.6, 42.8, 50.2];
            const multipleData = [12.5, 18.3, 25.8];

            // 设置样式
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C'
            };

            // 绘制坐标轴
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(60, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(60, 20);
            ctx.lineTo(60, height - 40);
            ctx.stroke();

            // 绘制IRR柱状图
            const barWidth = 80;
            const spacing = (width - 120) / scenarios.length;
            const irrScale = (height - 80) / 60;

            irrData.forEach((value, index) => {
                const x = 60 + spacing * index + spacing / 2 - barWidth / 2;
                const barHeight = value * irrScale;
                const y = height - 40 - barHeight;

                // 渐变填充
                const gradient = ctx.createLinearGradient(0, y, 0, height - 40);
                gradient.addColorStop(0, colors.primary);
                gradient.addColorStop(1, colors.secondary);
                ctx.fillStyle = gradient;
                ctx.fillRect(x, y, barWidth, barHeight);

                // 绘制数值标签
                ctx.fillStyle = '#374151';
                ctx.font = 'bold 14px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(value + '%', x + barWidth / 2, y - 5);

                // 绘制场景标签
                ctx.fillStyle = '#6b7280';
                ctx.font = '12px "Microsoft YaHei", sans-serif';
                ctx.fillText(scenarios[index], x + barWidth / 2, height - 25);
            });

            // 添加标题
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 16px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('内部收益率(IRR)对比分析', width / 2, 15);

            // 绘制收益倍数指示器
            const multipleY = height - 70;
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';
            multipleData.forEach((value, index) => {
                const x = 60 + spacing * index + spacing / 2 - 30;
                ctx.fillStyle = colors.accent;
                ctx.fillText(`${value}倍`, x, multipleY);
            });
        }

        // 系统架构图渲染函数
        function renderSystemArchitectureChart() {
            const canvas = document.getElementById('systemArchitectureChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40; // 减去padding
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 设置样式
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // 背景
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, width, height);

            // 绘制三层架构
            const layers = [
                {
                    name: '云管理平台',
                    y: 40,
                    color: colors.primary,
                    components: ['运营管理系统', '数据分析系统', '客户服务系统', '监控系统']
                },
                {
                    name: '场站管理系统',
                    y: 120,
                    color: colors.secondary,
                    components: ['功率分配系统', '环境监控系统', '安全防护系统', '计费系统']
                },
                {
                    name: '充电设备层',
                    y: 200,
                    color: colors.accent,
                    components: ['液冷超充桩', '储能系统', '光伏系统', '智能配电']
                }
            ];

            const componentWidth = Math.min(140, (width - 100) / 4);

            layers.forEach((layer, index) => {
                // 绘制层级标题背景
                ctx.fillStyle = layer.color;
                ctx.fillRect(30, layer.y - 15, width - 60, 35);

                // 绘制层级标题
                ctx.fillStyle = colors.text;
                ctx.font = 'bold 16px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(layer.name, width / 2, layer.y + 8);

                // 绘制组件
                ctx.font = '12px "Microsoft YaHei", sans-serif';
                layer.components.forEach((component, compIndex) => {
                    const compX = 50 + compIndex * (componentWidth + 15);
                    const compY = layer.y + 30;

                    // 组件背景
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.fillRect(compX, compY, componentWidth, 25);

                    // 组件边框
                    ctx.strokeStyle = layer.color;
                    ctx.lineWidth = 1;
                    ctx.strokeRect(compX, compY, componentWidth, 25);

                    // 组件文字 - 处理文字重叠
                    ctx.fillStyle = '#333';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';

                    // 如果文字太长，自动缩小字体
                    let fontSize = 12;
                    ctx.font = `${fontSize}px "Microsoft YaHei", sans-serif`;
                    const textWidth = ctx.measureText(component).width;

                    if (textWidth > componentWidth - 10) {
                        fontSize = Math.max(9, fontSize - 2);
                        ctx.font = `${fontSize}px "Microsoft YaHei", sans-serif`;
                    }

                    ctx.fillText(component, compX + componentWidth / 2, compY + 12.5);
                });

                // 绘制连接线和箭头
                if (index < layers.length - 1) {
                    ctx.strokeStyle = colors.grid;
                    ctx.lineWidth = 2;

                    // 多条连接线
                    for (let i = 0; i < 4; i++) {
                        const startX = 50 + i * (componentWidth + 15) + componentWidth / 2;
                        const startY = layer.y + 55;
                        const endY = layers[index + 1].y - 15;

                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(startX, endY);
                        ctx.stroke();

                        // 箭头
                        ctx.beginPath();
                        ctx.moveTo(startX - 3, endY - 5);
                        ctx.lineTo(startX, endY);
                        ctx.lineTo(startX + 3, endY - 5);
                        ctx.stroke();
                    }
                }
            });

            // 添加数据流向指示 - 放在左侧
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 3]);
            ctx.beginPath();
            ctx.moveTo(40, 40);
            ctx.lineTo(40, 240);
            ctx.stroke();
            ctx.setLineDash([]);

            // 绘制向下的箭头 - 放在虚线下方
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(40, 235);
            ctx.lineTo(35, 245);
            ctx.moveTo(40, 235);
            ctx.lineTo(45, 245);
            ctx.stroke();

            // 数据流向文字 - 放在左侧
            ctx.fillStyle = colors.success;
            ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
            ctx.save();
            ctx.translate(40, 140);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('数据流向', 0, 0);
            ctx.restore();
        }

        function renderPowerSystemChart() {
            const canvas = document.getElementById('powerSystemChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40;
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 设置样式
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // 背景
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, width, height);

            // 绘制电力系统流程
            const componentWidth = Math.min(110, (width - 140) / 5);
            const components = [
                {
                    name: '10kV/20kV电网',
                    specs: '10kV/20kV',
                    x: 20,
                    y: 120,
                    color: colors.primary
                },
                {
                    name: '变压器',
                    specs: '2000-5000kVA',
                    x: 20 + (componentWidth + 25) * 1,
                    y: 120,
                    color: colors.secondary
                },
                {
                    name: '配电系统',
                    specs: '400V系统',
                    x: 20 + (componentWidth + 25) * 2,
                    y: 120,
                    color: colors.accent
                },
                {
                    name: '功率分配',
                    specs: '7200kW',
                    x: 20 + (componentWidth + 25) * 3,
                    y: 120,
                    color: colors.success
                },
                {
                    name: '充电桩',
                    specs: '12×600kW',
                    x: 20 + (componentWidth + 25) * 4,
                    y: 120,
                    color: colors.warning
                }
            ];

            components.forEach((comp, index) => {
                // 绘制组件
                ctx.fillStyle = comp.color;
                ctx.fillRect(comp.x, comp.y, componentWidth, 60);

                // 绘制组件文字 - 处理文字重叠
                ctx.fillStyle = colors.text;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // 调整组件文字字体大小
                let nameFontSize = 12;
                ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                const nameWidth = ctx.measureText(comp.name).width;

                if (nameWidth > componentWidth - 10) {
                    nameFontSize = Math.max(9, nameFontSize - 2);
                    ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.name, comp.x + componentWidth / 2, comp.y + 20);

                // 绘制规格文字
                let specsFontSize = 10;
                ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                const specsWidth = ctx.measureText(comp.specs).width;

                if (specsWidth > componentWidth - 10) {
                    specsFontSize = Math.max(8, specsFontSize - 1);
                    ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.specs, comp.x + componentWidth / 2, comp.y + 40);
            });

            // 绘制连接箭头
            ctx.strokeStyle = colors.grid;
            ctx.lineWidth = 3;
            for (let i = 0; i < components.length - 1; i++) {
                const start = components[i];
                const end = components[i + 1];

                ctx.beginPath();
                ctx.moveTo(start.x + componentWidth, start.y + 30);
                ctx.lineTo(end.x, end.y + 30);
                ctx.stroke();

                // 箭头
                ctx.beginPath();
                ctx.moveTo(end.x - 8, end.y + 25);
                ctx.lineTo(end.x, end.y + 30);
                ctx.lineTo(end.x - 8, end.y + 35);
                ctx.stroke();
            }

            // 删除顶部绿色虚线 - 根据用户需求

            // 电能流向 - 放在底部并加上向右的箭头
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.setLineDash([8, 4]);
            ctx.beginPath();
            ctx.moveTo(60, height - 40);
            ctx.lineTo(width - 60, height - 40);
            ctx.stroke();
            ctx.setLineDash([]);

            // 绘制向右的箭头 - 确保箭头指向正确方向
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(width - 65, height - 40);
            ctx.lineTo(width - 55, height - 45);
            ctx.moveTo(width - 65, height - 40);
            ctx.lineTo(width - 55, height - 35);
            ctx.stroke();

            // 电能流向文字
            ctx.fillStyle = colors.success;
            ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('电能流向', width / 2, height - 55);
        }

        function renderCoolingSystemChart() {
            const canvas = document.getElementById('coolingSystemChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40;
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 设置样式
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // 背景
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, width, height);

            // 绘制液冷循环系统
            const centerX = width / 2;
            const centerY = height / 2 + 10;
            const radius = Math.min(100, width / 4);

            // 外圈循环管路
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();

            // 内圈循环管路
            ctx.strokeStyle = colors.secondary;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius - 30, 0, 2 * Math.PI);
            ctx.stroke();

            // 组件位置和规格
            const components = [
                {
                    name: '充电模块',
                    specs: '600kW',
                    x: centerX - radius,
                    y: centerY,
                    color: colors.warning,
                    temp: '65°C'
                },
                {
                    name: '冷却液',
                    specs: '乙二醇',
                    x: centerX,
                    y: centerY - radius,
                    color: colors.accent,
                    temp: '25°C'
                },
                {
                    name: '散热器',
                    specs: '液冷板',
                    x: centerX + radius,
                    y: centerY,
                    color: colors.success,
                    temp: '35°C'
                },
                {
                    name: '水泵',
                    specs: '200L/min',
                    x: centerX,
                    y: centerY + radius,
                    color: colors.primary,
                    temp: '28°C'
                }
            ];

            components.forEach((comp, index) => {
                // 绘制组件圆圈
                ctx.fillStyle = comp.color;
                ctx.beginPath();
                ctx.arc(comp.x, comp.y, 35, 0, 2 * Math.PI);
                ctx.fill();

                // 绘制组件边框
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
                ctx.lineWidth = 2;
                ctx.stroke();

                // 绘制组件名称 - 处理文字重叠
                ctx.fillStyle = colors.text;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                let nameFontSize = 12;
                ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                const nameWidth = ctx.measureText(comp.name).width;

                if (nameWidth > 60) {
                    nameFontSize = Math.max(9, nameFontSize - 2);
                    ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.name, comp.x, comp.y - 10);

                // 绘制规格
                let specsFontSize = 10;
                ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                const specsWidth = ctx.measureText(comp.specs).width;

                if (specsWidth > 60) {
                    specsFontSize = Math.max(8, specsFontSize - 1);
                    ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.specs, comp.x, comp.y + 2);

                // 绘制温度
                ctx.fillStyle = colors.accent;
                ctx.font = '9px "Microsoft YaHei", sans-serif';
                ctx.fillText(comp.temp, comp.x, comp.y + 14);
            });

            // 删除冷却液流向箭头 - 根据用户需求

            // 添加效率指标
            const metrics = [
                { label: '散热效率', value: '300W/°C', improvement: '+300%' },
                { label: '噪音控制', value: '<60dB', improvement: '-20%' },
                { label: '', value: '', improvement: '' },
                { label: '转换效率', value: '>96%', improvement: '+3%' }
            ];

            metrics.forEach((metric, index) => {
                const x = 20 + index * 120;
                const y = height - 35;

                ctx.fillStyle = colors.primary;
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                ctx.fillText(metric.label, x, y);

                ctx.fillStyle = colors.primary; // 修改value颜色与label相同
                ctx.font = 'bold 11px "Microsoft YaHei", sans-serif';
                ctx.fillText(metric.value, x, y + 15);

                ctx.fillStyle = colors.success;
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                ctx.fillText(metric.improvement, x, y + 30);
            });

            // 删除标题"液冷系统原理图" - 根据用户需求
        }

        function renderStationLayoutChart() {
            const canvas = document.getElementById('stationLayoutChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40; // Full width
            const height = 320;
            canvas.width = width;
            canvas.height = height;

            // 清除画布
            ctx.clearRect(0, 0, width, height);

            // 设置样式
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                light: '#B8C5E0',
                text: '#1D428A',
                white: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)'
            };

            // 绘制背景渐变
            const bgGradient = ctx.createLinearGradient(0, 0, width, height);
            bgGradient.addColorStop(0, 'rgba(255, 255, 255, 0.98)');
            bgGradient.addColorStop(1, 'rgba(184, 197, 224, 0.3)');
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, width, height);

            // 绘制充电站布局区域
            const stationWidth = Math.min(width - 80, 600);
            const stationHeight = 180;
            const stationX = (width - stationWidth) / 2;
            const stationY = 60;

            // 站点区域背景
            ctx.fillStyle = 'rgba(29, 66, 138, 0.05)';
            ctx.fillRect(stationX - 10, stationY - 10, stationWidth + 20, stationHeight + 60);

            // 站点边框
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 3;
            ctx.setLineDash([]);
            ctx.strokeRect(stationX, stationY, stationWidth, stationHeight);

            // 绘制充电桩布局 (4x3网格) - 优化尺寸避免重叠
            const chargerCols = 4;
            const chargerRows = 3;
            const chargerWidth = Math.min(stationWidth / (chargerCols + 1) - 5, 80);
            const chargerHeight = 28;
            const chargerSpacingX = stationWidth / (chargerCols + 1);
            const chargerSpacingY = 42;
            const startX = stationX + chargerSpacingX / 2;
            const startY = stationY + 25;

            for (let row = 0; row < chargerRows; row++) {
                for (let col = 0; col < chargerCols; col++) {
                    const x = startX + col * chargerSpacingX;
                    const y = startY + row * chargerSpacingY;

                    // 充电桩外框
                    ctx.fillStyle = colors.primary;
                    ctx.fillRect(x - chargerWidth/2, y - chargerHeight/2, chargerWidth, chargerHeight);

                    // 充电桩内框
                    ctx.fillStyle = colors.accent;
                    ctx.fillRect(x - chargerWidth/2 + 3, y - chargerHeight/2 + 3, chargerWidth - 6, chargerHeight - 6);

                    // 充电桩标识
                    ctx.fillStyle = colors.text;
                    ctx.font = 'bold 10px "Microsoft YaHei", sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(`600kW`, x, y);
                }
            }

            // 绘制入口和出口
            // 入口
            ctx.fillStyle = colors.secondary;
            ctx.fillRect(stationX - 25, stationY + stationHeight/2 - 20, 25, 40);
            ctx.fillStyle = colors.white;
            ctx.font = 'bold 14px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('入口', stationX - 12, stationY + stationHeight/2);

            // 出口
            ctx.fillStyle = colors.secondary;
            ctx.fillRect(stationX + stationWidth, stationY + stationHeight/2 - 20, 25, 40);
            ctx.fillStyle = colors.white;
            ctx.fillText('出口', stationX + stationWidth + 12, stationY + stationHeight/2);

            // 绘制道路标识
            ctx.strokeStyle = colors.light;
            ctx.lineWidth = 2;
            ctx.setLineDash([10, 5]);

            // 入口道路
            ctx.beginPath();
            ctx.moveTo(stationX - 25, stationY + stationHeight/2);
            ctx.lineTo(0, stationY + stationHeight/2);
            ctx.stroke();

            // 出口道路
            ctx.beginPath();
            ctx.moveTo(stationX + stationWidth + 25, stationY + stationHeight/2);
            ctx.lineTo(width, stationY + stationHeight/2);
            ctx.stroke();

            // 添加技术规格标注
            ctx.setLineDash([]);
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 18px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('超充电站标准布局设计', width / 2, 30);

            // 添加详细技术参数
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';

            // 左侧参数
            ctx.fillText(`• 充电桩数量：${chargerCols * chargerRows}台`, 20, height - 50);
            ctx.fillText(`• 单桩功率：600kW`, 20, height - 35);
            ctx.fillText(`• 总功率：${(chargerCols * chargerRows * 600).toLocaleString()}kW`, 20, height - 20);

            // 右侧参数
            ctx.textAlign = 'right';
            ctx.fillText('• 占地面积：1000m²', width - 20, height - 50);
            ctx.fillText('• 服务车位：12个', width - 20, height - 35);
            ctx.fillText('• 最大电流：600A', width - 20, height - 20);

            // 添加图例 - 居中于图表底部
            const legendY = stationY + stationHeight + 25;
            const legendItems = [
                { color: colors.accent, label: '超充桩' },
                { color: colors.light, label: '行车通道' }
            ];

            // 计算图例总宽度并居中
            const legendItemWidth = 100; // 每个图例项的宽度
            const totalLegendWidth = legendItems.length * legendItemWidth;
            const legendStartX = stationX + (stationWidth - totalLegendWidth) / 2;

            legendItems.forEach((item, index) => {
                const legendX = legendStartX + index * legendItemWidth;

                // 图例色块
                ctx.fillStyle = item.color;
                ctx.fillRect(legendX, legendY, 15, 15);

                // 图例文字
                ctx.fillStyle = colors.text;
                ctx.font = '11px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText(item.label, legendX + 20, legendY + 12);
            });
        }

        // 图片错误处理
        function handleImageError(img) {
            img.style.display = 'none';
            const wrapper = img.parentElement;
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'padding: 20px; background: #f8f9fa; border: 2px dashed #dee2e6; border-radius: 8px; text-align: center; color: #6c757d;';
            errorDiv.innerHTML = '图片加载失败<br><small>' + img.alt + '</small>';
            wrapper.appendChild(errorDiv);
        }

        // PDF导出功能
        function exportToPDF() {
            const exportBtn = document.querySelector('.pdf-export-btn');
            const originalText = exportBtn.innerHTML;

            // 显示加载状态
            exportBtn.innerHTML = '<span>⏳</span><span>生成中...</span>';
            exportBtn.disabled = true;

            // 创建隐藏的iframe用于打印
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.right = '0';
            iframe.style.bottom = '0';
            iframe.style.width = '0';
            iframe.style.height = '0';
            iframe.style.border = 'none';

            document.body.appendChild(iframe);

            // 重新渲染所有Canvas图表以确保PDF导出时内容完整
            setTimeout(() => {
                // 调用所有图表渲染函数
                renderInvestorMarketGrowthChart();
                renderInvestorMarketSizeChart();
                renderInvestorCashFlowChart();
                renderInvestorROIChart();
                renderSystemArchitectureChart();
                renderPowerSystemChart();
                renderCoolingSystemChart();
                renderStationLayoutChart();

                // 将Canvas转换为图片以确保PDF导出时内容完整
                setTimeout(() => {
                    const canvases = document.querySelectorAll('canvas');
                    const canvasPromises = [];

                    canvases.forEach((canvas, index) => {
                        const promise = new Promise((resolve) => {
                            try {
                                // 将canvas转换为base64图片
                                const dataURL = canvas.toDataURL('image/png', 1.0);
                                const img = document.createElement('img');

                                // 确保图片加载完成
                                img.onload = () => {
                                    // 设置样式，避免overflow: visible警告
                                    img.style.cssText = canvas.style.cssText + '; max-width: 100%; height: auto; display: block; overflow: hidden;';
                                    img.className = canvas.className + ' canvas-replacement';
                                    img.id = canvas.id + '-img';

                                    // 替换原始canvas
                                    canvas.parentNode.replaceChild(img, canvas);
                                    resolve();
                                };

                                img.onerror = () => {
                                    console.warn('Canvas图片加载失败:', canvas.id);
                                    resolve();
                                };

                                img.src = dataURL;
                            } catch (error) {
                                console.warn('Canvas转换失败:', canvas.id, error);
                                resolve();
                            }
                        });
                        canvasPromises.push(promise);
                    });

                    // 等待所有图片都加载完成
                    Promise.all(canvasPromises).then(() => {
                        console.log('所有Canvas图表已转换为图片');
                    });
                }, 200);
            }, 300);

            // 获取页面内容 - 等待图片完全加载
            setTimeout(() => {
                const pageContent = document.querySelector('.page-container').innerHTML;

                // 创建新窗口的内容 - 优化WYSIWYG效果
            const printContent = `
                <!DOCTYPE html>
                <html lang="zh-CN">
                <head>
                    <meta charset="UTF-8">
                    <title>千站液冷超充项目商业计划书</title>
                    <style>
                        @page {
                            size: A4;
                            margin: 15mm;
                        }

                        * {
                            box-sizing: border-box;
                        }

                        body {
                            font-family: 'Microsoft YaHei', 'SimHei', 'PingFang SC', -apple-system, BlinkMacSystemFont, Arial, sans-serif;
                            margin: 0;
                            padding: 0;
                            background: #ffffff;
                            color: #1a2332;
                            line-height: 1.6;
                            font-size: 14px;
                        }

                        .page-container {
                            display: block;
                            width: 100%;
                        }

                        .page {
                            width: 100%;
                            min-height: 277mm; /* A4 height minus margins */
                            margin: 0;
                            padding: 20mm;
                            background: #ffffff;
                            position: relative;
                            page-break-after: always;
                            overflow: hidden;
                            break-inside: avoid;
                        }

                        /* 图表容器避免分页 */
                        .chart-container, .canvas-container {
                            break-inside: avoid;
                            page-break-inside: avoid;
                            max-height: 200mm;
                            overflow: hidden;
                        }

                        canvas, .canvas-replacement {
                            break-inside: avoid;
                            page-break-inside: avoid;
                            max-height: 200mm;
                            max-width: 100% !important;
                            height: auto !important;
                            overflow: hidden;
                            display: block;
                        }

                        .page:last-child {
                            page-break-after: auto;
                        }

                        .page-content {
                            width: 100%;
                            height: 100%;
                        }

                        .page-number {
                            position: absolute;
                            bottom: 10mm;
                            right: 20mm;
                            font-size: 11px;
                            color: #666666;
                            font-family: Arial, sans-serif;
                        }

                        .header {
                            text-align: center;
                            margin-bottom: 30px;
                            border-bottom: 3px solid #FFC72C;
                            padding-bottom: 20px;
                        }

                        .title {
                            font-size: 32px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 10px;
                            text-shadow: none;
                        }

                        .subtitle {
                            font-size: 18px;
                            color: #0077C0;
                            margin-bottom: 5px;
                            font-weight: 500;
                        }

                        .meta {
                            font-size: 14px;
                            color: #666666;
                            margin: 5px 0;
                        }

                        .section {
                            margin-bottom: 25px;
                            page-break-inside: avoid;
                            break-inside: avoid;
                        }

                        /* 防止图表跨页 */
                        .chart-container {
                            page-break-inside: avoid;
                            break-inside: avoid;
                            margin: 20px 0;
                        }

                        /* Canvas图表和替换图片样式 */
                        canvas, .canvas-replacement {
                            max-width: 100% !important;
                            height: auto !important;
                            page-break-inside: avoid;
                            break-inside: avoid;
                            margin: 10px 0;
                            overflow: hidden;
                            display: block;
                        }

                        /* 图表描述文本 */
                        .chart-description {
                            margin: 15px 0;
                            page-break-inside: avoid;
                            break-inside: avoid;
                        }

                        .section-title {
                            font-size: 24px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 15px;
                            border-left: 5px solid #FFC72C;
                            padding-left: 15px;
                        }

                        .subsection-title {
                            font-size: 18px;
                            font-weight: bold;
                            color: #0077C0;
                            margin: 15px 0 10px 0;
                        }

                        .highlight-box {
                            background: rgba(255, 199, 44, 0.08);
                            border: 2px solid #FFC72C;
                            border-radius: 10px;
                            padding: 20px;
                            margin: 20px 0;
                        }

                        .highlight-title {
                            font-size: 20px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 10px;
                            text-align: center;
                        }

                        .data-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                            gap: 15px;
                            margin: 20px 0;
                        }

                        .data-card {
                            background: #f8f9fa;
                            border: 1px solid #e5e7eb;
                            border-radius: 8px;
                            padding: 15px;
                            text-align: center;
                            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                        }

                        .data-value {
                            font-size: 22px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 5px;
                        }

                        .data-label {
                            font-size: 12px;
                            color: #666666;
                        }

                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 15px 0;
                            font-size: 12px;
                        }

                        th, td {
                            border: 1px solid #d1d5db;
                            padding: 10px 8px;
                            text-align: left;
                            vertical-align: top;
                        }

                        th {
                            background: #f1f3f4;
                            font-weight: bold;
                            color: #1D428A;
                            font-size: 12px;
                        }

                        .highlight-row {
                            background: #fff3cd;
                            font-weight: bold;
                        }

                        .chart-container {
                            margin: 25px 0;
                            padding: 20px;
                            background: #ffffff;
                            border: 1px solid #e5e7eb;
                            border-radius: 10px;
                            page-break-inside: avoid;
                        }

                        .chart-title {
                            font-size: 18px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 15px;
                            text-align: center;
                        }

                        canvas {
                            max-width: 100%;
                            height: auto !important;
                            background: #ffffff;
                            border-radius: 6px;
                        }

                        .tech-images-grid {
                            display: grid;
                            grid-template-columns: repeat(2, 1fr);
                            gap: 20px;
                            margin: 20px 0;
                        }

                        .conclusion {
                            background: rgba(255, 199, 44, 0.08);
                            border: 2px solid #FFC72C;
                            border-radius: 10px;
                            padding: 20px;
                            margin-top: 30px;
                        }

                        .conclusion-title {
                            font-size: 18px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 15px;
                            text-align: center;
                        }

                        .contact {
                            text-align: center;
                            margin-top: 30px;
                            padding-top: 20px;
                            border-top: 1px solid #d1d5db;
                            font-size: 12px;
                            color: #666666;
                        }

                        ul, ol {
                            margin: 10px 0;
                            padding-left: 25px;
                        }

                        li {
                            margin-bottom: 6px;
                            font-size: 14px;
                            line-height: 1.5;
                        }

                        p {
                            font-size: 14px;
                            line-height: 1.6;
                            margin-bottom: 12px;
                            text-align: justify;
                            color: #1a2332;
                        }

                        strong, b {
                            color: #1D428A;
                            font-weight: 600;
                        }

                        em, i {
                            color: #666666;
                            font-style: italic;
                        }

                        /* 打印优化 */
                        @media print {
                            @page {
                                size: A4;
                                margin: 15mm;
                            }

                            body {
                                margin: 0;
                                -webkit-print-color-adjust: exact;
                                color-adjust: exact;
                            }

                            .page {
                                margin: 0;
                                box-shadow: none;
                                border: none;
                            }

                            .chart-container {
                                page-break-inside: avoid;
                            }

                            .section {
                                page-break-inside: avoid;
                            }
                        }
                    </style>
                </head>
                <body>
                    ${pageContent
                        .replace('page page-break', 'page')
                        .replace('<div class="page page-break" id="pdf-third-page">', '<div class="page">')
                        .replace(/page-content/g, 'page-content')
                        .replace(/<style>.*?<\/style>/gis, '') // 移除原有样式
                    }
                </body>
                </html>
            `;

            // 将内容写入iframe
            iframe.contentDocument.open();
            iframe.contentDocument.write(printContent);
            iframe.contentDocument.close();

            // 等待内容加载完成
            setTimeout(() => {
                try {
                    // 触发打印对话框
                    iframe.contentWindow.print();

                    // 恢复按钮状态
                    setTimeout(() => {
                        exportBtn.innerHTML = originalText;
                        exportBtn.disabled = false;

                        // 移除iframe
                        document.body.removeChild(iframe);
                    }, 1000);
                } catch (error) {
                    console.error('PDF导出失败:', error);

                    // 显示错误信息
                    exportBtn.innerHTML = '<span>❌</span><span>导出失败</span>';
                    setTimeout(() => {
                        exportBtn.innerHTML = originalText;
                        exportBtn.disabled = false;
                    }, 2000);

                    // 移除iframe
                    document.body.removeChild(iframe);
                }
            }, 1500); // 增加等待时间确保内容完全加载
            });
        }

        // 页面加载完成后初始化所有图表
        document.addEventListener('DOMContentLoaded', function() {
            // 延迟渲染确保DOM元素已创建
            setTimeout(() => {
                renderInvestorMarketGrowthChart();
                renderInvestorMarketSizeChart();
                renderInvestorCashFlowChart();
                renderInvestorROIChart();

                // 渲染系统架构图
                renderSystemArchitectureChart();
                renderPowerSystemChart();
                renderCoolingSystemChart();
                renderStationLayoutChart();

                // 设置图片错误处理
                document.querySelectorAll('.content-image').forEach(img => {
                    img.onerror = function() {
                        handleImageError(this);
                    };
                });
            }, 100);
        });
    </script>
</body>
</html>
